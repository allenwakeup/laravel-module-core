(window.webpackJsonp=window.webpackJsonp||[]).push([[4,5],{"6hkw":function(t,e,a){"use strict";a("PHw2")},"HN/Y":function(t,e,a){var i=a("cshs");"string"==typeof i&&(i=[[t.i,i,""]]);var n={hmr:!0,transform:void 0,insertInto:void 0};a("aET+")(i,n);i.locals&&(t.exports=i.locals)},PHw2:function(t,e,a){var i=a("Zxx6");"string"==typeof i&&(i=[[t.i,i,""]]);var n={hmr:!0,transform:void 0,insertInto:void 0};a("aET+")(i,n);i.locals&&(t.exports=i.locals)},WJkJ:function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},WKiH:function(t,e,a){var i=a("HYAF"),n=a("V37c"),s="["+a("WJkJ")+"]",r=RegExp("^"+s+s+"*"),o=RegExp(s+s+"*$"),c=function(t){return function(e){var a=n(i(e));return 1&t&&(a=a.replace(r,"")),2&t&&(a=a.replace(o,"")),a}};t.exports={start:c(1),end:c(2),trim:c(3)}},Zxx6:function(t,e,a){(t.exports=a("I1BE")(!1)).push([t.i,".payload-modal[data-v-6d80441a]{width:100%}",""])},apLa:function(t,e,a){"use strict";a("HN/Y")},cshs:function(t,e,a){(t.exports=a("I1BE")(!1)).push([t.i,".page_title[data-v-cf5ec19c]{font-size:14px;font-weight:700}.ant-list-item-meta-title.inactive[data-v-cf5ec19c]{color:#9c839f}.list_container[data-v-cf5ec19c]{border:1px solid #e8e8e8;border-radius:4px;overflow:auto;padding:0 5px 60px}.list_container.inactive[data-v-cf5ec19c]{background-color:#f9f9f9}.list-item[data-v-cf5ec19c]{padding:5px 7px;margin-bottom:0}.list-item .list-item-icon[data-v-cf5ec19c]{color:#d9ecff;font-size:20px}.list-item.active[data-v-cf5ec19c]{background-color:#547dc0;border-radius:5px;box-shadow:0 2px 12px 0 #cfcfcf}.list-item.active .ant-list-item-meta-title[data-v-cf5ec19c]{color:#d9ecff!important}.list-item.inactive .ant-list-item-meta-title[data-v-cf5ec19c]{color:#98939f}",""])},fQbI:function(t,e,a){"use strict";a.r(e);a("qePV"),a("rB9j"),a("UxlC"),a("ma9I"),a("pNMO"),a("4Brf"),a("07d7"),a("0oug"),a("4mDm"),a("PKPk"),a("3bBZ"),a("pjDv"),a("+2oP"),a("sMBO");function i(t){return function(t){if(Array.isArray(t))return n(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return n(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);"Object"===a&&t.constructor&&(a=t.constructor.name);if("Map"===a||"Set"===a)return Array.from(t);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return n(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,i=new Array(e);a<e;a++)i[a]=t[a];return i}var s={name:"AAssignment",components:{},props:{api:{type:String,required:!0,default:""},title:{type:String,default:""},actions:{type:Object},parameterReplacement:{type:String,default:""},leftParameter:{type:String,default:"id"},rightParameter:{type:String,default:"id"},width:{type:String,default:"40%"},height:{type:Number,default:420}},data:function(){return{select_list_item:void 0,search_left:"",loading:!0,loading_left:!0,loading_right:!1,data_left:[],data_right_source:[],data_right_target:[],data_right_selected:[]}},computed:{_api:function(){return this.api}},watch:{_api:function(t){this.onload()}},methods:{onload:function(){var t=this;this.isEmpty(this.api)||this.$get(this.api,{}).then((function(e){t.loading=!1,t.loading_left=!1,t.data_left=e.data.data})),this.loading=!0,this.loading_left=!0},onSearchLeft:function(t){this.search_left=t},showAssignment:function(t){var e=this;if(this.select_list_item!==t){if(this.select_list_item=t,this.data_right_selected=[],this.isEmpty(this.actions.source))return this.$message.error("API source 未定义");this.loading_right=!0,this.data_right_source=[],this.data_right_target=[],this.$get(this.isEmpty(this.parameterReplacement)?this.actions.source+"/"+t:this.actions.source.replace(this.parameterReplacement,t)).then((function(a){if(e.data_right_source=a.data,e.isEmpty(e.actions.target))return e.$message.error("API target 未定义");e.$get(e.isEmpty(e.parameterReplacement)?e.actions.target+"/"+t:e.actions.target.replace(e.parameterReplacement,t)).then((function(t){e.loading_right=!1,e.data_right_target=t.data}))}))}},handleChange:function(t,e,a){var i=this;if(!this.isEmpty(this.actions[e])){var n=this.isEmpty(this.parameterReplacement)?this.actions[e]+"/"+this.select_list_item:this.actions[e].replace(this.parameterReplacement,this.select_list_item),s={},r=this.data_right_target.concat([]);switch(s[this[e+"Parameter"]]=a,e){case"right":this.data_right_target=r.concat(a),this.$post(n,s).then((function(t){if(200!=t.code&&201!=t.code)return i.data_right_target=r,i.$message.error(t.msg);i.data_right_selected=a,i.$message.success(t.msg)})).catch((function(){i.data_right_target=r}));break;case"left":var o=a.reduce((function(t,e){return t["_"+e]=!0,t}),{});this.data_right_target=r.reduce((function(t,e){return o["_"+e]||t.push(e),t}),[]),this.$delete(n,s).then((function(t){if(200!=t.code&&204!=t.code)return i.data_right_target=r,i.$message.error(t.msg);i.data_right_selected=a,i.$message.success(t.msg)})).catch((function(){i.data_right_target=r}))}}},handleSelectChange:function(t,e){this.data_right_selected=[].concat(i(t),i(e))},isEmpty:function(t){return null==t||""===t||0===t.length}},created:function(){},mounted:function(){}},r=(a("apLa"),a("KHd+")),o={components:{AAssignment:Object(r.a)(s,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"page_title"},[t._v(t._s(t.title))]),t._v(" "),a("div",{staticClass:"unline underm"}),t._v(" "),a("div",{staticClass:"page_body"},[a("a-spin",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}]}),t._v(" "),a("a-row",{directives:[{name:"show",rawName:"v-show",value:!t.loading,expression:"!loading"}],style:{height:t.height+"px"},attrs:{gutter:8}},[a("a-col",{attrs:{span:8}},[a("div",[a("a-input-search",{attrs:{size:"large",placeholder:"搜索"},on:{search:t.onSearchLeft}})],1),t._v(" "),a("div",{staticClass:"list_container",class:{inactive:t.loading_right},style:{height:t.height-40+"px"}},[a("a-list",{staticClass:"list",attrs:{size:"small",loading:t.loading_left,"item-layout":"horizontal","data-source":t.data_left},scopedSlots:t._u([{key:"renderItem",fn:function(e,i){return a("a-list-item",{staticClass:"list-item",class:{active:t.select_list_item===e.value,inactive:t.loading_right},on:{click:function(a){return t.showAssignment(e.value)}}},[a("a-list-item-meta",[a("span",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(e.title))])]),t._v(" "),a("a-icon",{directives:[{name:"show",rawName:"v-show",value:t.select_list_item===e.value,expression:"select_list_item === item.value"}],staticClass:"list-item-icon",attrs:{type:"check"}})],1)}}])})],1)]),t._v(" "),a("a-col",{attrs:{span:16}},[a("a-spin",{directives:[{name:"show",rawName:"v-show",value:t.loading_right,expression:"loading_right"}]}),t._v(" "),a("a-transfer",{attrs:{titles:["未分配","已分配"],operations:["分配","取消"],"show-search":"",showSelectAll:"","list-style":{width:t.width,height:t.height+"px"},"data-source":t.data_right_source,"target-keys":t.data_right_target,"selected-keys":t.data_right_selected,render:function(t){return t.title}},on:{change:t.handleChange,selectChange:t.handleSelectChange}},[a("span",{attrs:{slot:"notFoundContent"},slot:"notFoundContent"},[t._v("\n                      没数据\n                    ")])])],1)],1)],1)])}),[],!1,null,"cf5ec19c",null).exports},props:{assignmentId:{type:Number,default:-1}},data:function(){return{id:0,info:{}}},watch:{_assignmentId:function(t){t>0&&this.onload()}},computed:{_assignmentId:function(){return this.assignmentId}},methods:{get_form:function(){var t=this;this.$get(this.$api.moduleCoreDataMaps+"_"+this.id+"/"+this.id+"/assignment").then((function(e){t.info=e.data}))},onload:function(){this.$isEmpty(this.$route.params.id)?this.assignmentId>0&&this.id!==this.assignmentId&&(this.id=this.assignmentId,this.get_form()):(this.id=this.$route.params.id,this.get_form())}},created:function(){this.onload()},mounted:function(){}},c=(a("6hkw"),Object(r.a)(o,(function(){var t=this.$createElement;return(this._self._c||t)("a-assignment",{attrs:{title:this.info.title,api:this.info.api,actions:this.info.actions,"parameter-replacement":":left_id"}})}),[],!1,null,"6d80441a",null));e.default=c.exports},qePV:function(t,e,a){"use strict";var i=a("g6v/"),n=a("2oRo"),s=a("lMq5"),r=a("busE"),o=a("UTVS"),c=a("xrYK"),l=a("cVYH"),d=a("2bX/"),u=a("wE6v"),h=a("0Dky"),p=a("fHMY"),f=a("JBy8").f,m=a("Bs8V").f,g=a("m/L8").f,_=a("WKiH").trim,v=n.Number,y=v.prototype,w="Number"==c(p(y)),x=function(t){if(d(t))throw TypeError("Cannot convert a Symbol value to a number");var e,a,i,n,s,r,o,c,l=u(t,"number");if("string"==typeof l&&l.length>2)if(43===(e=(l=_(l)).charCodeAt(0))||45===e){if(88===(a=l.charCodeAt(2))||120===a)return NaN}else if(48===e){switch(l.charCodeAt(1)){case 66:case 98:i=2,n=49;break;case 79:case 111:i=8,n=55;break;default:return+l}for(r=(s=l.slice(2)).length,o=0;o<r;o++)if((c=s.charCodeAt(o))<48||c>n)return NaN;return parseInt(s,i)}return+l};if(s("Number",!v(" 0o1")||!v("0b1")||v("+0x1"))){for(var b,I=function(t){var e=arguments.length<1?0:t,a=this;return a instanceof I&&(w?h((function(){y.valueOf.call(a)})):"Number"!=c(a))?l(new v(x(e)),a,I):x(e)},A=i?f(v):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger,fromString,range".split(","),k=0;A.length>k;k++)o(v,b=A[k])&&!o(I,b)&&g(I,b,m(v,b));I.prototype=y,y.constructor=I,r(n,"Number",I)}},yTyi:function(t,e,a){"use strict";a.r(e);a("oVuX");var i={components:{AAssignment:a("fQbI").default},props:{},data:function(){return{params:{page:1,per_page:30},total:0,selectedRowKeys:[],columns:[{title:"#",dataIndex:"id",fixed:"left",width:80},{title:"数据路径",scopedSlots:{customRender:"data_route_id"},width:220},{title:"左表",scopedSlots:{customRender:"left"},width:220},{title:"左表模板",dataIndex:"left_tpl",width:180},{title:"右表",scopedSlots:{customRender:"right"},width:220},{title:"右表模板",dataIndex:"right_tpl",width:180},{title:"关联关系",dataIndex:"relationshipText",width:180},{title:"Foreign Pivot Key",dataIndex:"foreign_pivot_key",width:200},{title:"Related Pivot Key",dataIndex:"related_pivot_key",width:200},{title:"Parent Key",dataIndex:"parent_key",width:200},{title:"Related Key",dataIndex:"related_key",width:200},{title:"多态前缀",dataIndex:"name",width:180},{title:"描述",dataIndex:"description",width:150},{title:"存储位置",dataIndex:"table",width:180},{title:"状态",dataIndex:"status",width:90},{title:"创建时间",dataIndex:"created_at",width:200},{title:"更新时间",dataIndex:"updated_at",width:200},{title:"操作",fixed:"right",scopedSlots:{customRender:"action"}}],list:[],selectedAssignment:{},openAssignmentModal:!1}},watch:{},computed:{},methods:{onSelectChange:function(t){this.selectedRowKeys=t},onChange:function(t){this.params.page=t},del:function(){var t=this;if(0===this.selectedRowKeys.length)return this.$message.error("未选择数据.");this.$confirm({title:"你确定要删除选择的数据？",content:"确定删除后无法恢复.",okText:"是",okType:"danger",cancelText:"取消",onOk:function(){var e=t.selectedRowKeys.join(",");t.$delete(t.$api.moduleCoreDataMaps+"/"+e).then((function(e){200===e.code?(t.onload(),t.$message.success("删除成功")):t.$message.error(e.msg)}))}})},onload:function(){var t=this;this.$get(this.$api.moduleCoreDataMaps,this.params).then((function(e){t.total=e.data.total,t.list=e.data.data}))},handleAssignment:function(t){this.selectedAssignment=t,this.openAssignmentModal=!0}},created:function(){this.onload()},mounted:function(){}},n=a("KHd+"),s=Object(n.a)(i,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"admin_table_page_title"},[t._v("数据映射列表")]),t._v(" "),a("div",{staticClass:"unline underm"}),t._v(" "),a("div",{staticClass:"admin_table_handle_btn"},[a("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:function(e){return t.$router.push("/Admin/goodcatch/m/core/data_maps/form")}}},[t._v("添加")]),t._v(" "),a("a-button",{staticClass:"admin_delete_btn",attrs:{type:"danger",icon:"delete"},on:{click:t.del}},[t._v("批量删除")])],1),t._v(" "),a("div",{staticClass:"admin_table_list"},[a("a-table",{attrs:{columns:t.columns,"data-source":t.list,scroll:{x:2048,y:400},pagination:!1,"row-selection":{selectedRowKeys:t.selectedRowKeys,onChange:t.onSelectChange},"row-key":"id"},scopedSlots:t._u([{key:"data_route_id",fn:function(e){return a("span",{},[t._v("\n                "+t._s(e.dataRoute?e.dataRoute.name:e.data_route_id)+"\n            ")])}},{key:"left",fn:function(e){return a("span",{},[t._v("\n                "+t._s(e.left+e.left_table)+"\n            ")])}},{key:"right",fn:function(e){return a("span",{},[t._v("\n                "+t._s(e.right+e.right_table)+"\n            ")])}},{key:"action",fn:function(e,i){return a("span",{},[a("a-button",{attrs:{icon:"edit"},on:{click:function(a){return t.$router.push("/Admin/goodcatch/m/core/data_maps/form/"+e.id)}}},[t._v("编辑")]),t._v(" "),a("a-button",{attrs:{icon:"interaction"},on:{click:function(e){return t.handleAssignment(i)}}},[t._v("分配")])],1)}}])}),t._v(" "),t.total>0?a("div",{staticClass:"admin_pagination"},[a("a-pagination",{attrs:{"page-size":t.params.per_page,total:t.total,"show-less-items":""},on:{"update:pageSize":function(e){return t.$set(t.params,"per_page",e)},"update:page-size":function(e){return t.$set(t.params,"per_page",e)},change:t.onChange},model:{value:t.params.page,callback:function(e){t.$set(t.params,"page",e)},expression:"params.page"}})],1):t._e()],1),t._v(" "),a("a-modal",{attrs:{title:"数据映射","body-style":{overflow:"scroll",height:"500px"},"dialog-style":{top:"20px"},width:"80%",height:"600px"},model:{value:t.openAssignmentModal,callback:function(e){t.openAssignmentModal=e},expression:"openAssignmentModal"}},[a("template",{slot:"footer"},[a("span")]),t._v(" "),a("a-assignment",{attrs:{"assignment-id":t.selectedAssignment.id}})],2)],1)}),[],!1,null,"4d089fea",null);e.default=s.exports}}]);