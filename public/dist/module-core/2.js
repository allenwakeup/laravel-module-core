(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{"7e5n":function(t,e,i){var a=i("Rm9Z");"string"==typeof a&&(a=[[t.i,a,""]]);var s={hmr:!0,transform:void 0,insertInto:void 0};i("aET+")(a,s);a.locals&&(t.exports=a.locals)},CMON:function(t,e,i){"use strict";i("FI5i")},FI5i:function(t,e,i){var a=i("Jn6M");"string"==typeof a&&(a=[[t.i,a,""]]);var s={hmr:!0,transform:void 0,insertInto:void 0};i("aET+")(a,s);a.locals&&(t.exports=a.locals)},Jn6M:function(t,e,i){(t.exports=i("I1BE")(!1)).push([t.i,".ant-tree li .ant-tree-node-content-wrapper.ant-tree-node-selected[data-v-47d808de]{background:#13c2c2!important}.draggable-handle[data-v-47d808de]{position:absolute;height:100%!important;cursor:col-resize;touch-action:none;border:none;transform:none!important;box-shadow:inset 0 0 3px #999}.container-left[data-v-47d808de]{overflow-x:hidden;box-shadow:inset -.5px 0 1px #cfcfcf}.container-right[data-v-47d808de]{box-shadow:inset 0 -.5px 1px #cfcfcf}.loading-left[data-v-47d808de]{background-color:#fcfcfc}",""])},Rm9Z:function(t,e,i){(t.exports=i("I1BE")(!1)).push([t.i,".payload-modal[data-v-1a2e8d7b]{width:100%}",""])},"byW/":function(t,e,i){(t.exports=i("I1BE")(!1)).push([t.i,".page_title[data-v-20d6e6e4]{font-size:14px;font-weight:700}.ant-list-item-meta-title.inactive[data-v-20d6e6e4]{color:#9c839f}.list_container[data-v-20d6e6e4]{border:1px solid #e8e8e8;border-radius:4px;overflow:auto;padding:0 5px 60px}.list_container.inactive[data-v-20d6e6e4]{background-color:#f9f9f9}.list-item[data-v-20d6e6e4]{padding:5px 7px;margin-bottom:0}.list-item .list-item-icon[data-v-20d6e6e4]{color:#d9ecff;font-size:20px}.list-item.active[data-v-20d6e6e4]{background-color:#547dc0;border-radius:5px;box-shadow:0 2px 12px 0 #cfcfcf}.list-item.active .ant-list-item-meta-title[data-v-20d6e6e4]{color:#d9ecff!important}.list-item.inactive .ant-list-item-meta-title[data-v-20d6e6e4]{color:#98939f}",""])},egba:function(t,e,i){"use strict";i("7e5n")},fQbI:function(t,e,i){"use strict";i.r(e);i("qePV"),i("rB9j"),i("UxlC"),i("ma9I"),i("pNMO"),i("4Brf"),i("07d7"),i("0oug"),i("4mDm"),i("PKPk"),i("3bBZ"),i("pjDv"),i("+2oP"),i("sMBO");function a(t){return function(t){if(Array.isArray(t))return s(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return s(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return s(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,a=new Array(e);i<e;i++)a[i]=t[i];return a}var r={name:"AAssignment",components:{},props:{api:{type:String,required:!0,default:""},title:{type:String,default:""},actions:{type:Object},parameterReplacement:{type:String,default:""},leftParameter:{type:String,default:"id"},rightParameter:{type:String,default:"id"},width:{type:String,default:"40%"},height:{type:Number,default:420}},data:function(){return{select_list_item:void 0,search_left:"",loading:!0,loading_left:!0,loading_right:!1,data_left:[],data_right_source:[],data_right_target:[],data_right_selected:[]}},computed:{},watch:{},methods:{onload:function(){var t=this;this.isEmpty(this.api)||this.$get(this.api,{}).then((function(e){200===e.code&&(t.loading=!1,t.loading_left=!1,t.data_left=e.data.data)})),this.loading=!0,this.loading_left=!0},onSearchLeft:function(t){this.search_left=t},showAssignment:function(t){var e=this;if(this.select_list_item!==t){if(this.select_list_item=t,this.data_right_selected=[],this.isEmpty(this.actions.source))return this.$message.error("API source 未定义");this.loading_right=!0,this.data_right_source=[],this.data_right_target=[],this.$get(this.isEmpty(this.parameterReplacement)?this.actions.source+"/"+t:this.actions.source.replace(this.parameterReplacement,t)).then((function(i){if(e.data_right_source=i.data,e.isEmpty(e.actions.target))return e.$message.error("API target 未定义");e.$get(e.isEmpty(e.parameterReplacement)?e.actions.target+"/"+t:e.actions.target.replace(e.parameterReplacement,t)).then((function(t){e.loading_right=!1,e.data_right_target=t.data}))}))}},handleChange:function(t,e,i){var a=this;if(!this.isEmpty(this.actions[e])){var s=this.isEmpty(this.parameterReplacement)?this.actions[e]+"/"+this.select_list_item:this.actions[e].replace(this.parameterReplacement,this.select_list_item),r={},n=this.data_right_target.concat([]);switch(r[this[e+"Parameter"]]=i,e){case"right":this.data_right_target=n.concat(i),this.$post(s,r).then((function(t){if(200!=t.code&&201!=t.code)return a.data_right_target=n,a.$message.error(t.msg);a.data_right_selected=i,a.$message.success(t.msg)})).catch((function(){a.data_right_target=n}));break;case"left":var o=i.reduce((function(t,e){return t["_"+e]=!0,t}),{});this.data_right_target=n.reduce((function(t,e){return o["_"+e]||t.push(e),t}),[]),this.$delete(s,r).then((function(t){if(200!=t.code&&204!=t.code)return a.data_right_target=n,a.$message.error(t.msg);a.data_right_selected=i,a.$message.success(t.msg)})).catch((function(){a.data_right_target=n}))}}},handleSelectChange:function(t,e){this.data_right_selected=[].concat(a(t),a(e))},isEmpty:function(t){return null==t||""===t||0===t.length}},created:function(){this.onload()},mounted:function(){}},n=(i("uhkC"),i("KHd+")),o=Object(n.a)(r,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"page_title"},[t._v(t._s(t.title))]),t._v(" "),i("div",{staticClass:"unline underm"}),t._v(" "),i("div",{staticClass:"page_body"},[i("a-spin",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}]}),t._v(" "),i("a-row",{directives:[{name:"show",rawName:"v-show",value:!t.loading,expression:"!loading"}],style:{height:t.height+"px"},attrs:{gutter:8}},[i("a-col",{attrs:{span:8}},[i("div",[i("a-input-search",{attrs:{size:"large",placeholder:"搜索"},on:{search:t.onSearchLeft}})],1),t._v(" "),i("div",{staticClass:"list_container",class:{inactive:t.loading_right},style:{height:t.height-40+"px"}},[i("a-list",{staticClass:"list",attrs:{size:"small",loading:t.loading_left,"item-layout":"horizontal","data-source":t.data_left},scopedSlots:t._u([{key:"renderItem",fn:function(e,a){return i("a-list-item",{staticClass:"list-item",class:{active:t.select_list_item===e.value,inactive:t.loading_right},on:{click:function(i){return t.showAssignment(e.value)}}},[i("a-list-item-meta",[i("span",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(e.title))])]),t._v(" "),i("a-icon",{directives:[{name:"show",rawName:"v-show",value:t.select_list_item===e.value,expression:"select_list_item === item.value"}],staticClass:"list-item-icon",attrs:{type:"check"}})],1)}}])})],1)]),t._v(" "),i("a-col",{attrs:{span:16}},[i("a-spin",{directives:[{name:"show",rawName:"v-show",value:t.loading_right,expression:"loading_right"}]}),t._v(" "),i("a-transfer",{attrs:{titles:["未分配","已分配"],operations:["分配","取消"],"show-search":"",showSelectAll:"","list-style":{width:t.width,height:t.height+"px"},"data-source":t.data_right_source,"target-keys":t.data_right_target,"selected-keys":t.data_right_selected,render:function(t){return t.title}},on:{change:t.handleChange,selectChange:t.handleSelectChange}},[i("span",{attrs:{slot:"notFoundContent"},slot:"notFoundContent"},[t._v("\n                      没数据\n                    ")])])],1)],1)],1)])}),[],!1,null,"20d6e6e4",null).exports,l=(i("TeQF"),i("hByQ"),i("zKZe"),i("yq1k"),i("JTJg"),i("2B1R"),i("FZtP"),i("oVuX"),i("tkto"),i("zqxM")),c=i.n(l),h=i("WQwz"),d={components:{Search:i("FAbG").a},props:{titles:{type:Array},operations:{type:Array},search:{type:Object},left:{type:Object},right:{type:Object,required:!0,default:function(){return{source:{},target:{}}}},leftWidth:{type:Number,default:300}},data:function(){return{width:this.leftWidth,leftData:[],source:[],selectedKeys:[],targetKeys:[],leftSelectedKeys:void 0,leftSelectedNodes:void 0}},methods:{onDrag:function(t,e){this.width=Math.max(t,this.leftWidth)},filterTransferOptions:function(t,e){return this.right&&"function"===this.right.filter?this.right.filter(t,e):-1!==e.title.indexOf(t)},loadLeftData:function(){var t=this;if(this.left&&!this.$isEmpty(this.left.api)){this.left.loading=!0,this.reset();var e=this.left?this.search.params:{};this.leftData=[],this.$get(this.left.api,Object.assign({},e,this.left.params)).then((function(e){200===e.code?e.data&&("function"==typeof t.left.transform?t.leftData=t.left.transform(e.data):t.leftData=e.data):t.$message.error(e.msg),t.left.loading=!1}),(function(e){t.$message.error(e),t.left.loading=!1}))}else if(this.left&&this.left.data)"function"==typeof this.left.transform?this.leftData=this.left.transform(this.right.source.data):this.leftData=this.left.data;else if(this.left&&this.left.load)if("function"==typeof this.left.load){this.left.loading=!0;var i=this.left?this.search.params:{};this.left.load(Object.assign({},i,this.left.params)).then((function(e){t.left.loading=!1,"function"==typeof t.left.transform?t.leftData=t.left.transform(e):t.leftData=e}),(function(e){t.left.loading=!1}))}else this.leftData=this.left.data;else this.$message.error("未定义数据源.")},loadRightSourceData:function(){var t=this;if(this.right&&this.right.source&&!this.$isEmpty(this.right.source.api)){this.right.source.loading=!0;var e=this.left?{}:this.search.params,i=this.handleApiParamsReplacement(this.right.source.api,Object.assign({},e,this.right.source.params),this.right.source),a=i.api,s=i.params;this.source=[],this.$get(a,s).then((function(e){200===e.code?e.data&&("function"==typeof t.right.source.transform?t.source=t.right.source.transform({data:e.data,selectedKeys:t.leftSelectedKeys,selects:t.leftSelectedNodes}):t.source=e.data,t.source.length>0&&t.loadRightDefault()):t.$message.error(e.msg),t.right.source.loading=!1}),(function(e){t.$message.error(e),t.right.source.loading=!1}))}else this.right&&this.right.source&&this.right.source.data?"function"==typeof this.right.source.transform?this.source=this.right.source.transform({data:this.right.source.data,selectedKeys:this.leftSelectedKeys,selects:this.leftSelectedNodes}):this.source=this.right.source.data:this.$message.error("未定义数据源.")},loadRightDefault:function(){var t=this;if(this.right&&this.right.default)if(this.$isEmpty(this.right.default.api))this.selectedKeys=this.right.default.data||[];else{var e=this.left?{}:this.search.params,i=this.handleApiParamsReplacement(this.right.default.api,Object.assign({},e,this.right.default.params),this.right.default),a=i.api,s=i.params;this.selectedKeys=[],this.$get(a,s).then((function(e){200===e.code?e.data&&("function"==typeof t.right.default.transform?t.selectedKeys=t.right.default.transform({data:e.data,selectedKeys:t.leftSelectedKeys,selects:t.leftSelectedNodes}):t.selectedKeys=e.data):t.$message.error(e.msg)}),(function(e){t.$message.error(e)}))}},loadRightTargetData:function(){var t=this;if(this.right&&this.right.target&&!this.$isEmpty(this.right.target.api)){this.right.target.loading=!0;var e=this.left?{}:this.search.params,i=this.handleApiParamsReplacement(this.right.target.api,Object.assign({},e,this.right.target.params),this.right.target),a=i.api,s=i.params;this.targetKeys=[],this.$get(a,s).then((function(e){200===e.code?e.data&&("function"==typeof t.right.target.transform?t.targetKeys=t.right.target.transform({data:e.data,selectedKeys:t.leftSelectedKeys,selects:t.leftSelectedNodes}):t.targetKeys=e.data):t.$message.error(e.msg),t.right.target.loading=!1}),(function(e){t.$message.error(e),t.right.target.loading=!1}))}else this.$message.error("未定义数据源.")},handleSearchParams:function(t){this.search&&(this.search.params=t),this.onload()},onRightChange:function(t,e,i){this.targetKeys=t,this.$emit("change",{targetKeys:t,direction:e,moveKeys:i,selectedKeys:this.leftSelectedKeys,selects:this.leftSelectedNodes,data:this.source.filter((function(t){return i.includes(t.key)}))})},onRightSelectChange:function(t,e){var i=this;this.selectedKeys=(t||[]).concat(e||[]),this.left||this.$emit("select",{selectedKeys:this.selectedKeys,selects:this.source.filter((function(t){return i.selectedKeys.includes(t.key)}))})},onSelectLeft:function(t,e){t.length>0&&(this.leftSelectedKeys=t,this.leftSelectedNodes=this.findLeftSelectedNodes(this.leftData),this.$emit("select",{selectedKeys:t,selects:this.leftSelectedNodes}),this.loadRightSourceData(),this.loadRightTargetData())},getRowSelection:function(t){var e=t.disabled,i=t.selectedKeys,a=t.itemSelectAll,s=t.itemSelect;return{columnWidth:25,getCheckboxProps:function(t){return{props:{disabled:e||t.disabled}}},onSelectAll:function(t,e){var s=e.filter((function(t){return!t.disabled})).map((function(t){return t.key})),r=t?c()(s,i):c()(i,s);a(r,t)},onSelect:function(t,e){var i=t.key;s(i,e)},selectedRowKeys:i}},handleApiParamsReplacement:function(t,e,i){var a=this;if(this.leftSelectedKeys&&this.leftSelectedKeys.length>0&&this.leftSelectedNodes&&this.leftSelectedNodes.length>0){var s=[].concat(i.replacements||[]),r=Object(h.h)(i.parameters)?i.parameters.reduce((function(t,e){return t[e]=e,t}),{}):i.parameters||{};this.$isEmpty(i.replacement)||s.push(i.replacement),this.$isEmpty(i.parameter)||(r[i.parameter]=i.parameter),s.length>0&&s.forEach((function(e){t=t.replace("{".concat(e,"}"),a.leftSelectedNodes.reduce((function(t,i){return t.push(i[e]),t}),[]).join(i.join||","))})),Object.keys(r).filter((function(t){return r.hasOwnProperty(t)})).length>0&&Object.keys(r).filter((function(t){return r.hasOwnProperty(t)&&!Object(h.i)(r[t])})).forEach((function(t){return e[r[t]]=left_selected.reduce((function(e,i){return e.push(i[t]),e}),[]).join(i.join||",")}))}return{api:t,params:e}},findLeftSelectedNodes:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=[];return this.leftSelectedKeys&&e&&e.length>0&&e.forEach((function(e){e.children&&e.children.length>0&&(i=i.concat(e.children.filter((function(e){return(!e.children||0===e.children.length)&&t.leftSelectedKeys.includes(e.id)}))),e.children.filter((function(t){return!!t.children&&t.children.length>0})).forEach((function(e){i=i.concat(t.findLeftSelectedNodes(e.children))})))})),i},reset:function(){this.source=[],this.selectedKeys=[],this.targetKeys=[],this.leftSelectedKeys=void 0,this.leftSelectedNodes=void 0},onload:function(){this.left?this.loadLeftData():(this.loadRightSourceData(),this.loadRightTargetData())}},created:function(){this.onload()},mounted:function(){}},f=(i("CMON"),Object(n.a)(d,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t.search?i("search",{attrs:{"search-config":t.search.fields,"auto-params":t.search.params},on:{searchParams:t.handleSearchParams}}):t._e(),t._v(" "),i("a-row",{staticStyle:{position:"relative"},attrs:{type:"flex",gutter:16}},[t.left?i("vue-draggable-resizable",{staticClass:"draggable-handle",style:{left:t.width+"px"},attrs:{w:10,x:t.leftWidth,z:1,axis:"x",parent:!0,resizable:!1},on:{dragging:t.onDrag}}):t._e(),t._v(" "),t.left?i("a-col",{class:{"container-left":!!t.left,"loading-left":!!t.left&&t.left.loading},style:{flex:"0 0 "+t.width+"px"},attrs:{flex:t.leftWidth+"px"}},[i("a-spin",{directives:[{name:"show",rawName:"v-show",value:!!t.left&&t.left.loading,expression:"!!left && left.loading"}],attrs:{size:"small"}}),t._v(" "),t.leftData&&t.leftData.length>0?i("a-tree",{attrs:{multiple:!!t.left.multiple,"tree-data":t.leftData,"show-line":"","replace-fields":{children:"children",title:"name",key:"id",value:"id"}},on:{select:t.onSelectLeft}},[i("a-icon",{attrs:{slot:"switcherIcon",type:"down"},slot:"switcherIcon"})],1):t._e(),t._v(" "),t.leftData&&0!==t.leftData.length||t.left&&t.left.loading?t._e():i("p",[t._v("没有找到更多的数据...")])],1):t._e(),t._v(" "),i("a-col",{class:{"container-right":!!t.left},attrs:{flex:"auto"}},[i("a-transfer",{attrs:{"data-source":t.source,"selected-keys":t.selectedKeys,"target-keys":t.targetKeys,titles:t.titles,"list-style":{maxHeight:"100%",width:t.width+"px"},operations:t.operations,"show-search":"","filter-option":t.filterTransferOptions,"show-select-all":!1},on:{change:t.onRightChange,selectChange:t.onRightSelectChange},scopedSlots:t._u([{key:"children",fn:function(e){var a=e.props,s=a.direction,r=a.filteredItems,n=a.selectedKeys,o=a.disabled,l=e.on,c=l.itemSelectAll,h=l.itemSelect;return[i("a-table",{style:{pointerEvents:o?"none":null},attrs:{"row-selection":t.getRowSelection({disabled:o,selectedKeys:n,itemSelectAll:c,itemSelect:h}),columns:"left"===s?t.right.source.columns:t.right.target.columns,components:"left"===s?t.right.source.components:t.right.target.components,"data-source":r,loading:"left"===s?t.right.source.loading:t.right.target.loading,size:"small","custom-row":function(t){var e=t.key,i=t.disabled;return{on:{click:function(){i||o||h(e,!n.includes(e))}}}}}})]}}])},[t._v(" "),i("span",{attrs:{slot:"notFoundContent"},slot:"notFoundContent"},[t._v("\n                  没有找到更多的数据\n                ")])])],1)],1)],1)}),[],!1,null,"47d808de",null).exports,{components:{AAssignment:o},props:{assignmentId:{type:Number,default:-1}},data:function(){return{id:0,info:{actions:{},api:"",title:""}}},watch:{},computed:{},methods:{get_form:function(){var t=this;this.$get(this.$api.adminDataMaps+"_"+this.id+"/"+this.id+"/assignment").then((function(e){200===e.code&&(t.info=e.data)}))},onload:function(){this.$isEmpty(this.$route.params.id)?this.assignmentId>0&&this.id!==this.assignmentId&&(this.id=this.assignmentId,this.get_form()):(this.id=this.$route.params.id,this.get_form())}},created:function(){this.onload()},mounted:function(){}}),u=(i("egba"),Object(n.a)(f,(function(){var t=this.$createElement;return(this._self._c||t)("a-assignment",{attrs:{title:this.info.title,api:this.info.api,actions:this.info.actions,"parameter-replacement":":left_id"}})}),[],!1,null,"1a2e8d7b",null));e.default=u.exports},uOqf:function(t,e,i){var a=i("byW/");"string"==typeof a&&(a=[[t.i,a,""]]);var s={hmr:!0,transform:void 0,insertInto:void 0};i("aET+")(a,s);a.locals&&(t.exports=a.locals)},uhkC:function(t,e,i){"use strict";i("uOqf")}}]);